<div align="center">
  <h1>Fixit Cloud ‚òÅÔ∏è Module: AWS Lambda</h1>

Terraform module for defining and managing an AWS Lambda function.

</div>

<h2>Table of Contents</h2>

- [Useful Links](#useful-links)
- [‚öôÔ∏è Module Usage](#Ô∏è-module-usage)
  - [Usage Examples](#usage-examples)
  - [Requirements](#requirements)
  - [Providers](#providers)
  - [Modules](#modules)
  - [Resources](#resources)
  - [Inputs](#inputs)
  - [Outputs](#outputs)
- [üìù License](#-license)
- [üí¨ Contact](#-contact)

## Useful Links

- AWS Lambda Documentation:
  - [Lambda API Reference](https://docs.aws.amazon.com/lambda/latest/dg/API_Reference.html)
  - [Lambda Event Source Mapping: Filter Syntax](https://docs.aws.amazon.com/lambda/latest/dg/invocation-eventfiltering.html#filtering-syntax)

<!-- BEGINNING OF PRE-COMMIT-TERRAFORM DOCS HOOK -->
<!-- prettier-ignore-start -->

---

## ‚öôÔ∏è Module Usage

### Usage Examples

- Terragrunt: [view Terragrunt usage exmaple](examples/terragrunt.hcl)
- Terraform: &nbsp;[view vanilla Terraform usage exmaple](examples/terraform.tf)

### Requirements

| Name                                                                     | Version   |
| ------------------------------------------------------------------------ | --------- |
| <a name="requirement_terraform"></a> [terraform](#requirement_terraform) | 1.2.7     |
| <a name="requirement_aws"></a> [aws](#requirement_aws)                   | ~> 4.11.0 |

### Providers

| Name                                             | Version   |
| ------------------------------------------------ | --------- |
| <a name="provider_aws"></a> [aws](#provider_aws) | ~> 4.11.0 |

### Modules

No modules.

### Resources

| Name                                                                                                                                                                | Type     |
| ------------------------------------------------------------------------------------------------------------------------------------------------------------------- | -------- |
| [aws_lambda_event_source_mapping.map](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/lambda_event_source_mapping)                      | resource |
| [aws_lambda_function.this](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/lambda_function)                                             | resource |
| [aws_lambda_permission.map](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/lambda_permission)                                          | resource |
| [aws_lambda_provisioned_concurrency_config.this](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/lambda_provisioned_concurrency_config) | resource |

### Inputs

| Name                                                                                                                                 | Description                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | Type                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       | Default           | Required |
| ------------------------------------------------------------------------------------------------------------------------------------ | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ | ----------------- | :------: |
| <a name="input_dead_letter_target_arn"></a> [dead_letter_target_arn](#input_dead_letter_target_arn)                                  | (Optional) ARN of SNS Topic or SQS Queue to notify when a function invocation<br>fails. If this option is used, the function's IAM role must be granted suitable<br>access to write to the target object, which means allowing either the sns:Publish<br>or sqs:SendMessage action on this ARN, depending on which service is targeted.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               | `string`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   | `null`            |    no    |
| <a name="input_deployment_package_src"></a> [deployment_package_src](#input_deployment_package_src)                                  | The Lambda deployment package source; must be either an absolute path<br>to an executable on the local filesystem, an image URI, or an object<br>configuring retrieval from an S3 bucket.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             | <pre>object({<br> local_file_abs_path = optional(string)<br> image_uri = optional(string)<br> s3_bucket = optional(object({<br> bucket_name = string<br> object_key = string<br> object_version = string<br> }))<br> })</pre>                                                                                                                                                                                                                                                                                                                                                                                                              | n/a               |   yes    |
| <a name="input_description"></a> [description](#input_description)                                                                   | (Optional) The Lambda function description.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | `string`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   | `null`            |    no    |
| <a name="input_environment_variables"></a> [environment_variables](#input_environment_variables)                                     | (Optional) Map of env vars to make accessible to the function during execution.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       | `map(string)`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              | `null`            |    no    |
| <a name="input_event_source_mapping"></a> [event_source_mapping](#input_event_source_mapping)                                        | (Optional) Config object to setup an event source mapping for the Lambda function.<br>This allows Lambda functions to get events from Kinesis, DynamoDB, SQS, Amazon MQ<br>and Managed Streaming for Apache Kafka (MSK). Reference documentation for these<br>arguments is available [here][var-ref-event-src-mapping].                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               | <pre>object({<br> enabled = optional(bool)<br> event_source_arn = optional(string)<br> filter_patterns = optional(list(string))<br> starting_position = optional(string)<br> starting_position_timestamp = optional(string) # RFC3339 timestamp<br> queues = optional(string)<br> batch_size = optional(number)<br> maximum_batching_window_in_seconds = optional(number)<br> maximum_record_age_in_seconds = optional(number)<br> maximum_retry_attempts = optional(number)<br> destination_config = optional(object({<br> on_success_dest_resource_arn = string<br> on_failure_dest_resource_arn = optional(string)<br> }))<br> })</pre> | `{}`              |    no    |
| <a name="input_execution_role_arn"></a> [execution_role_arn](#input_execution_role_arn)                                              | The IAM Role ARN for the function's execution role.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   | `string`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   | n/a               |   yes    |
| <a name="input_handler"></a> [handler](#input_handler)                                                                               | The Lambda function handler.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          | `string`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   | `"index.handler"` |    no    |
| <a name="input_lambda_permissions"></a> [lambda_permissions](#input_lambda_permissions)                                              | (Optional) Map of principal names to Lambda permission config objects. Gives an<br>external source (like an EventBridge Rule, SNS, or S3) permission to access the<br>Lambda function. The principals can be AWS services, like "events.amazonaws.com",<br>or AWS account IDs - any external principal that requires permission to invoke<br>the Lambda function. With "qualifier" you can optionally narrow the permission to<br>just a specific version or function alias. To ensure the permissions granted are<br>not too broad, AWS service principals must be provided with a "source_arn"; for<br>example, if the principal is EventBridge (events.amazonaws.com), the "source_arn"<br>would be that of the EventBridge Rule. "principal_org_id" can be used to provide<br>permissions to all accounts within an Organization. | <pre>map(<br> # map keys: principal names ("events.amazonaws.com", account IDs, etc.)<br> object({<br> action = string # e.g., "lambda:InvokeFunction"<br> statement_id = optional(string)<br> qualifier = optional(string) # option to specify a version or alias<br> source_account = optional(string)<br> source_arn = optional(string) # Required if principal is an AWS service<br> principal_org_id = optional(string) # Principal would be the Org root account<br> })<br> )</pre>                                                                                                                                                  | n/a               |   yes    |
| <a name="input_name"></a> [name](#input_name)                                                                                        | The Lambda function name.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             | `string`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   | n/a               |   yes    |
| <a name="input_provisioned_concurrent_executions"></a> [provisioned_concurrent_executions](#input_provisioned_concurrent_executions) | (Optional) Amount of capacity to allocate. Must be greater than or equal to 1 (default 1).                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            | `number`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   | `1`               |    no    |
| <a name="input_runtime"></a> [runtime](#input_runtime)                                                                               | (Optional) The Lambda function runtime; see link below for valid runtime values.<br>https://docs.aws.amazon.com/lambda/latest/dg/API_CreateFunction.html#SSS-CreateFunction-request-Runtime                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | `string`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   | `null`            |    no    |
| <a name="input_tags"></a> [tags](#input_tags)                                                                                        | (Optional) The Lambda function tags.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  | `map(string)`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              | `null`            |    no    |
| <a name="input_vpc_config"></a> [vpc_config](#input_vpc_config)                                                                      | (Optional) VPC configs for the Lambda function.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       | <pre>object({<br> security_group_ids = list(string)<br> subnet_ids = list(string)<br> })</pre>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             | `null`            |    no    |

### Outputs

| Name                                                                             | Description                          |
| -------------------------------------------------------------------------------- | ------------------------------------ |
| <a name="output_Lambda_Function"></a> [Lambda_Function](#output_Lambda_Function) | The Lambda function resource object. |

---

## üìù License

All scripts and source code contained herein are for commercial use only by Nerdware, LLC.

See [LICENSE](/LICENSE) for more information.

<div align="center" style="margin-top:30px;">

## üí¨ Contact

Trevor Anderson - [@TeeRevTweets](https://twitter.com/teerevtweets) - [Trevor@Nerdware.cloud](mailto:trevor@nerdware.cloud)

  <a href="https://www.youtube.com/channel/UCguSCK_j1obMVXvv-DUS3ng">
    <img src="../.github/assets/YouTube_icon_circle.svg" height="40" />
  </a>
  &nbsp;
  <a href="https://www.linkedin.com/in/meet-trevor-anderson/">
    <img src="../.github/assets/LinkedIn_icon_circle.svg" height="40" />
  </a>
  &nbsp;
  <a href="https://twitter.com/TeeRevTweets">
    <img src="../.github/assets/Twitter_icon_circle.svg" height="40" />
  </a>
  &nbsp;
  <a href="mailto:trevor@nerdware.cloud">
    <img src="../.github/assets/email_icon_circle.svg" height="40" />
  </a>
  <br><br>

  <a href="https://daremightythings.co/">
    <strong><i>Dare Mighty Things.</i></strong>
  </a>

</div>
<!-- prettier-ignore-end -->
<!-- END OF PRE-COMMIT-TERRAFORM DOCS HOOK -->

<!-- LINKS -->

<!-- Below link in variables.tf -->

[var-ref-event-src-mapping]: https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/lambda_event_source_mapping
